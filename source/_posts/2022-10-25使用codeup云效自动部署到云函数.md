---
title: 使用codeup云效自动部署到云函数
categories:
  - Serverless
date: 2022-10-25 13:38:29
tags:
  - ci/cd
  - FC
---


## 云效code


<!--more-->


## 1. codeup建立代码仓库

使用gin 框架,golang:1.19
`Dockerfile`文件放入你的项目中

```sh
FROM  golang:1.13.9-alpine3.11 as  build
WORKDIR /app
COPY . /app
# 构建
RUN   go env -w GO111MODULE=on && \
      go env -w GOPROXY=https://goproxy.cn,direct && \
     go mod tidy  && \
      CGO_ENABLED=0 GOOS=linux && \
     go build -o main main.go

FROM alpine:latest

WORKDIR /app
COPY --from=build /app/main  /app/main
RUN ls -lah /app
EXPOSE 9000

CMD ["/app/main"]
```

## 2. 选择codeup的流水线，并且建立



### 注意填写构建标签`${DATETIME}`

![Jietu20221025-203425.jpg][1]
![Jietu20221025-203509.jpg][2]



### 源码类型：自定义镜像

镜像地址 填写上面的docker 仓库地址， 注意填写完整地址和版本  :`${DATETIME}`

例如. https://xxx.com/xx/xx:`${DATETIME}`


![Jietu20221025-203627.jpg][3]

### 运行，发现云函数也更新了
![Jietu20221025-203841.jpg][4]
![Jietu20221025-204022.jpg][5]


[1]: ./typecho/uploads/2022/10/3214353463.jpg
[2]: ./typecho/uploads/2022/10/3283806154.jpg
[3]: ./typecho/uploads/2022/10/3185295873.jpg
[4]: ./typecho/uploads/2022/10/3759745812.jpg
[5]: ./typecho/uploads/2022/10/2430124402.jpg